6. System Administration


		mysql> CREATE TABLE sa_specialties (
		    ->     specialty_id INT AUTO_INCREMENT PRIMARY KEY,
		    ->     specialty_name VARCHAR(50) UNIQUE
		    -> );
		Query OK, 0 rows affected (0.05 sec)
		
		mysql> INSERT INTO sa_specialties (specialty_name) VALUES
		    -> ('Cardiology'),
		    -> ('Orthopedics'),
		    -> ('Neurology');
		Query OK, 3 rows affected (0.01 sec)
		Records: 3  Duplicates: 0  Warnings: 0
		
		mysql> CREATE TABLE sa_doctors_ref (
		    ->     doctor_id INT AUTO_INCREMENT PRIMARY KEY,
		    ->     doctor_name VARCHAR(50),
		    ->     specialty_id INT
		    -> );
		Query OK, 0 rows affected (0.02 sec)
		
		mysql> INSERT INTO sa_doctors_ref (doctor_name, specialty_id) VALUES
		    -> ('Dr. Anil Kumar', 1),
		    -> ('Dr. Sunita Jain', 2);
		Query OK, 2 rows affected (0.01 sec)
		Records: 2  Duplicates: 0  Warnings: 0
		
		mysql> CREATE TABLE sa_backup_log (
		    ->     backup_id INT AUTO_INCREMENT PRIMARY KEY,
		    ->     table_name VARCHAR(50),
		    ->     backup_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
		    ->     status VARCHAR(20)
		    -> );
		Query OK, 0 rows affected (0.04 sec)

		mysql>     CREATE TABLE sa_audit_log (
		    ->     audit_id INT AUTO_INCREMENT PRIMARY KEY,
		    ->     user_name VARCHAR(50),
		    ->     table_name VARCHAR(50),
		    ->     action VARCHAR(20),
		    ->     action_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
		    -> );
		Query OK, 0 rows affected (0.04 sec)
		
		mysql> CREATE TRIGGER sa_specialty_insert_audit
		    -> AFTER INSERT ON sa_specialties
		    -> FOR EACH ROW
		    -> INSERT INTO sa_audit_log (user_name, table_name, action)
		    -> VALUES ('ADMIN', 'sa_specialties', 'INSERT');
		Query OK, 0 rows affected (0.02 sec)
		
		mysql> INSERT INTO sa_audit_log (user_name, table_name, action)
		    -> VALUES
		    -> ('ADMIN', 'sa_specialties', 'UPDATE'),
		    -> ('SYSTEM', 'sa_doctors_ref', 'DELETE');
		Query OK, 2 rows affected (0.01 sec)
		Records: 2  Duplicates: 0  Warnings: 0
UC-6.1: Manage Specialty Lookup
Actor: Administrator
Flow: CRUD operations on specialties reference table. Check foreign key constraints before DELETE using COUNT subquery.
	
	code->
	
	CREATE (Add specialty):
		INSERT INTO sa_specialties (specialty_name)
		VALUES ('Dermatology');
	
	READ (View specialties)
		SELECT * FROM sa_specialties;
		
			mysql> SELECT * FROM sa_specialties;
			+--------------+----------------+
			| specialty_id | specialty_name |
			+--------------+----------------+
			|            1 | Cardiology     |
			|            4 | Dermatology    |
			|            3 | Neurology      |
			|            2 | Orthopedics    |
			+--------------+----------------+
			4 rows in set (0.00 sec)
	
	
	UPDATE (Rename specialty)
		UPDATE sa_specialties
		SET specialty_name = 'Neuro Science'
		WHERE specialty_id = 3;
		Query OK, 1 row affected (0.01 sec)
		Rows matched: 1  Changed: 1  Warnings: 0
		
		DELETE (Check FK constraint before delete)
		
			SELECT COUNT(*) AS usage_count
			FROM sa_doctors_ref
			WHERE specialty_id = 1;
		
			If count = 0, then delete:
			
			DELETE FROM sa_specialties
			WHERE specialty_id = 1;
		
		
		
UC-6.2: Database Backup Trigger
Actor: System (Scheduled)
Flow: Execute JDBC batch operations to export critical tables. Use DatabaseMetaData to retrieve schema information for backup validation.
	
	code->
	
		mysql> INSERT INTO sa_backup_log (table_name, status)
		    -> VALUES
		    -> ('sa_specialties', 'SUCCESS'),
		    -> ('sa_doctors_ref', 'SUCCESS');
		Query OK, 2 rows affected (0.01 sec)
		Records: 2  Duplicates: 0  Warnings: 0
		
		
		mysql> SELECT * FROM sa_backup_log;
		+-----------+----------------+---------------------+---------+
		| backup_id | table_name     | backup_date         | status  |
		+-----------+----------------+---------------------+---------+
		|         1 | sa_specialties | 2026-02-08 16:41:31 | SUCCESS |
		|         2 | sa_doctors_ref | 2026-02-08 16:41:31 | SUCCESS |
		+-----------+----------------+---------------------+---------+
		2 rows in set (0.00 sec)
		
UC-6.3: View System Audit Logs
Actor: Administrator
Flow: Query audit_log table populated via database triggers on INSERT/UPDATE/DELETE. Filter by user, table_name, timestamp using complex WHERE conditions.

	 code->
	 
		mysql> SELECT *
		    -> FROM sa_audit_log
		    -> WHERE user_name = 'ADMIN'
		    -> AND table_name = 'sa_specialties'
		    -> AND action_time BETWEEN '2026-03-01' AND '2026-03-31';
		Empty set (0.00 sec)
	 